{{- if .Values.config }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "backend.fullname" . }}-config
  labels:
    {{- include "backend.labels" . | nindent 4 }}
data:
  {{- if .Values.config.langsmith }}
  LANGSMITH_TRACING: {{ .Values.config.langsmith.tracing | quote }}
  LANGSMITH_API_KEY: {{ .Values.config.langsmith.apiKey | quote }}
  LANGSMITH_PROJECT: {{ .Values.config.langsmith.project | quote }}
  {{- end }}
  {{- if .Values.config.clustering }}
  SENTENCE_TRANSFORMER_MODEL_NAME: {{ .Values.config.clustering.sentenceTransformerModelName | quote }}
  CLUSTERING_ALGORITHM: {{ .Values.config.clustering.algorithm | quote }}
  TMP_CLUSTER_MODEL_PATH: {{ .Values.config.clustering.tmpClusterModelPath | quote }}
  {{- end }}
  {{- if .Values.rag.enabled }}
  # RAG Configuration
  RAG_ENABLED: {{ .Values.rag.enabled | quote }}
  EMBEDDINGS_LLM_MODEL_NAME: {{ .Values.rag.embedding.modelName | quote }}
  {{- if .Values.rag.embedding.apiUrl }}
  EMBEDDINGS_LLM_URL: {{ .Values.rag.embedding.apiUrl | quote }}
  {{- end }}
  DATA_DIR: {{ .Values.rag.dataDir | quote }}
  KNOWLEDGE_BASE_DIR: {{ .Values.rag.knowledgeBaseDir | quote }}
  RAG_TOP_K: {{ .Values.rag.query.topK | quote }}
  RAG_TOP_N: {{ .Values.rag.query.topN | quote }}
  RAG_SIMILARITY_THRESHOLD: {{ .Values.rag.query.similarityThreshold | quote }}
  {{- end }}
{{- end }}
